
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Not a Pkg Tool - Windows/Intune packaging with PSADT">
      
      
        <meta name="author" content="Roger Cibrian">
      
      
        <link rel="canonical" href="https://rogercibrian.github.io/notapkgtool/api/build/">
      
      
        <link rel="prev" href="../validation/">
      
      
        <link rel="next" href="../config/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>build - NAPT Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#build" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="NAPT Documentation" class="md-header__button md-logo" aria-label="NAPT Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            NAPT Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              build
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="deep-orange"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/RogerCibrian/notapkgtool" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    RogerCibrian/notapkgtool
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../quick-start/" class="md-tabs__link">
        
  
  
    
  
  Quick Start

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../user-guide/" class="md-tabs__link">
        
  
  
    
  
  User Guide

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../cli/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../changelog/" class="md-tabs__link">
        
  
  
    
  
  Changelog

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../roadmap/" class="md-tabs__link">
        
  
  
    
  
  Roadmap

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../contributing/" class="md-tabs__link">
        
  
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="NAPT Documentation" class="md-nav__button md-logo" aria-label="NAPT Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    NAPT Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/RogerCibrian/notapkgtool" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    RogerCibrian/notapkgtool
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../quick-start/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quick Start
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../user-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    User Guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    cli
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../core/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    core
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4_4" id="__nav_4_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Modules
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_4">
            <span class="md-nav__icon md-icon"></span>
            Modules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    build
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    build
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#notapkgtool.build.manager" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;manager
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notapkgtool.build.manager.build_package" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;build_package
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notapkgtool.build.template" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;template
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notapkgtool.build.template.generate_invoke_script" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_invoke_script
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notapkgtool.build.packager" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;packager
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" packager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notapkgtool.build.packager.create_intunewin" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_intunewin
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    config
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../discovery/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    discovery
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../io/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    io
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../policy/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    policy
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../psadt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    psadt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../state/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    state
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../versioning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    versioning
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Roadmap
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#notapkgtool.build.manager" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;manager
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" manager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notapkgtool.build.manager.build_package" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;build_package
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notapkgtool.build.template" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;template
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" template">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notapkgtool.build.template.generate_invoke_script" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;generate_invoke_script
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#notapkgtool.build.packager" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-module"></code>&nbsp;packager
    </span>
  </a>
  
    <nav class="md-nav" aria-label=" packager">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#notapkgtool.build.packager.create_intunewin" class="md-nav__link">
    <span class="md-ellipsis">
      <code class="doc-symbol doc-symbol-toc doc-symbol-function"></code>&nbsp;create_intunewin
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="build">build</h1>
<p>The build module handles PSADT package creation and .intunewin packaging for Intune deployment.</p>


<div class="doc doc-object doc-module">



<h2 id="notapkgtool.build.manager" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">notapkgtool.build.manager</span>


</h2>

    <div class="doc doc-contents first">

        <p>Build manager for PSADT package creation.</p>
<p>This module orchestrates the complete build process for creating PSADT
packages from recipes and downloaded installers.</p>


<details class="private-helpers" open>
  <summary>Private Helpers</summary>
  <ul>
<li>_get_installer_version: Extract version from downloaded installer</li>
<li>_find_installer_file: Locate installer in downloads directory</li>
<li>_create_build_directory: Create build directory structure</li>
<li>_copy_psadt_pristine: Copy PSADT files from cache</li>
<li>_copy_installer: Copy installer to Files/ directory</li>
<li>_apply_branding: Replace PSADT assets with custom branding</li>
</ul>
</details>

<details class="design-principles" open>
  <summary>Design Principles</summary>
  <ul>
<li>Filesystem is source of truth for version information</li>
<li>Entire PSADT Template_v4 structure copied pristine</li>
<li>Invoke-AppDeployToolkit.ps1 is generated from template (not copied)</li>
<li>Build directories are versioned: {app_id}/{version}/</li>
<li>Branding applied by replacing files in root Assets/ directory (v4 structure)</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>from pathlib import Path
from notapkgtool.build import build_package</p>
<p>result = build_package(
    recipe_path=Path("recipes/Google/chrome.yaml"),
    downloads_dir=Path("downloads"),
)</p>
<p>print(f"Built: {result['build_dir']}")</p>
</details>









  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="notapkgtool.build.manager.build_package" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">build_package</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">build_package</span><span class="p">(</span><span class="n">recipe_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">downloads_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Build a PSADT package from a recipe and downloaded installer.</p>
<p>This is the main entry point for the build process. It:</p>
<ol>
<li>Loads the recipe configuration</li>
<li>Finds the downloaded installer</li>
<li>Extracts version from installer (filesystem is truth)</li>
<li>Gets/downloads PSADT release</li>
<li>Creates build directory structure</li>
<li>Copies PSADT files (pristine)</li>
<li>Generates Invoke-AppDeployToolkit.ps1 from template</li>
<li>Copies installer to Files/</li>
<li>Applies custom branding</li>
</ol>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>recipe_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the recipe YAML file.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>downloads_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory containing the downloaded
installer. Default: Path("downloads")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Base directory for build output.
Default: From config or Path("builds")</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show verbose progress output. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>debug</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show debug output. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dict (app_id, app_name, version, build_dir, psadt_version, status),
where app_id is the application ID, app_name is the application
name, version is the application version, build_dir is the Path
to the build directory, psadt_version is the PSADT version used,
and status is the build status.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If recipe or installer doesn't exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If build process fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Basic build:</p>
<pre><code>result = build_package(Path("recipes/Google/chrome.yaml"))
print(result['build_dir'])  # builds/napt-chrome/141.0.7390.123
</code></pre>
<p>Custom output directory:</p>
<pre><code>result = build_package(
    Path("recipes/Google/chrome.yaml"),
    output_dir=Path("custom/builds")
)
</code></pre>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Requires installer to be downloaded first (run 'napt discover').
Version extracted from installer file, not state cache. Overwrites
existing build directory if it exists. PSADT files are copied pristine
from cache. Invoke-AppDeployToolkit.ps1 is generated (not copied).</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>notapkgtool/build/manager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">build_package</span><span class="p">(</span>
    <span class="n">recipe_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">downloads_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Build a PSADT package from a recipe and downloaded installer.</span>

<span class="sd">    This is the main entry point for the build process. It:</span>

<span class="sd">    1. Loads the recipe configuration</span>
<span class="sd">    2. Finds the downloaded installer</span>
<span class="sd">    3. Extracts version from installer (filesystem is truth)</span>
<span class="sd">    4. Gets/downloads PSADT release</span>
<span class="sd">    5. Creates build directory structure</span>
<span class="sd">    6. Copies PSADT files (pristine)</span>
<span class="sd">    7. Generates Invoke-AppDeployToolkit.ps1 from template</span>
<span class="sd">    8. Copies installer to Files/</span>
<span class="sd">    9. Applies custom branding</span>

<span class="sd">    Args:</span>
<span class="sd">        recipe_path: Path to the recipe YAML file.</span>
<span class="sd">        downloads_dir: Directory containing the downloaded</span>
<span class="sd">            installer. Default: Path(&quot;downloads&quot;)</span>
<span class="sd">        output_dir: Base directory for build output.</span>
<span class="sd">            Default: From config or Path(&quot;builds&quot;)</span>
<span class="sd">        verbose: Show verbose progress output. Default is False.</span>
<span class="sd">        debug: Show debug output. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict (app_id, app_name, version, build_dir, psadt_version, status),</span>
<span class="sd">            where app_id is the application ID, app_name is the application</span>
<span class="sd">            name, version is the application version, build_dir is the Path</span>
<span class="sd">            to the build directory, psadt_version is the PSADT version used,</span>
<span class="sd">            and status is the build status.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If recipe or installer doesn&#39;t exist.</span>
<span class="sd">        RuntimeError: If build process fails.</span>

<span class="sd">    Example:</span>
<span class="sd">        Basic build:</span>

<span class="sd">            result = build_package(Path(&quot;recipes/Google/chrome.yaml&quot;))</span>
<span class="sd">            print(result[&#39;build_dir&#39;])  # builds/napt-chrome/141.0.7390.123</span>

<span class="sd">        Custom output directory:</span>

<span class="sd">            result = build_package(</span>
<span class="sd">                Path(&quot;recipes/Google/chrome.yaml&quot;),</span>
<span class="sd">                output_dir=Path(&quot;custom/builds&quot;)</span>
<span class="sd">            )</span>

<span class="sd">    Note:</span>
<span class="sd">        Requires installer to be downloaded first (run &#39;napt discover&#39;).</span>
<span class="sd">        Version extracted from installer file, not state cache. Overwrites</span>
<span class="sd">        existing build directory if it exists. PSADT files are copied pristine</span>
<span class="sd">        from cache. Invoke-AppDeployToolkit.ps1 is generated (not copied).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">notapkgtool.cli</span><span class="w"> </span><span class="kn">import</span> <span class="n">print_step</span><span class="p">,</span> <span class="n">print_verbose</span>

    <span class="c1"># Load configuration</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Loading configuration...&quot;</span><span class="p">)</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">load_effective_config</span><span class="p">(</span><span class="n">recipe_path</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">)</span>

    <span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;apps&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">app_id</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;unknown-app&quot;</span><span class="p">)</span>
    <span class="n">app_name</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;Unknown App&quot;</span><span class="p">)</span>

    <span class="c1"># Set defaults</span>
    <span class="k">if</span> <span class="n">downloads_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">downloads_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;downloads&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span>
            <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;defaults&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;build&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;output_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;builds&quot;</span><span class="p">)</span>
        <span class="p">)</span>

    <span class="c1"># Find installer file</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Finding installer...&quot;</span><span class="p">)</span>
    <span class="n">installer_file</span> <span class="o">=</span> <span class="n">_find_installer_file</span><span class="p">(</span><span class="n">downloads_dir</span><span class="p">,</span> <span class="n">config</span><span class="p">)</span>

    <span class="c1"># Extract version from installer or state (filesystem + state are truth)</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Extracting version from installer...&quot;</span><span class="p">)</span>
    <span class="n">state_file</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;state/versions.json&quot;</span><span class="p">)</span>  <span class="c1"># Default state file location</span>
    <span class="n">version</span> <span class="o">=</span> <span class="n">_get_installer_version</span><span class="p">(</span><span class="n">installer_file</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">state_file</span><span class="p">)</span>

    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Building </span><span class="si">{</span><span class="n">app_name</span><span class="si">}</span><span class="s2"> v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Get PSADT release</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Getting PSADT release...&quot;</span><span class="p">)</span>
    <span class="n">psadt_config</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;defaults&quot;</span><span class="p">,</span> <span class="p">{})</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;psadt&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">release_spec</span> <span class="o">=</span> <span class="n">psadt_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;release&quot;</span><span class="p">,</span> <span class="s2">&quot;latest&quot;</span><span class="p">)</span>
    <span class="n">cache_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">psadt_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;cache_dir&quot;</span><span class="p">,</span> <span class="s2">&quot;cache/psadt&quot;</span><span class="p">))</span>

    <span class="n">psadt_cache_dir</span> <span class="o">=</span> <span class="n">get_psadt_release</span><span class="p">(</span>
        <span class="n">release_spec</span><span class="p">,</span> <span class="n">cache_dir</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span>
    <span class="p">)</span>
    <span class="n">psadt_version</span> <span class="o">=</span> <span class="n">psadt_cache_dir</span><span class="o">.</span><span class="n">name</span>  <span class="c1"># Directory name is the version</span>

    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Using PSADT </span><span class="si">{</span><span class="n">psadt_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Create build directory</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Creating build structure...&quot;</span><span class="p">)</span>
    <span class="n">build_dir</span> <span class="o">=</span> <span class="n">_create_build_directory</span><span class="p">(</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">app_id</span><span class="p">,</span> <span class="n">version</span><span class="p">)</span>

    <span class="c1"># Copy PSADT files (pristine)</span>
    <span class="n">_copy_psadt_pristine</span><span class="p">(</span><span class="n">psadt_cache_dir</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">)</span>

    <span class="c1"># Generate Invoke-AppDeployToolkit.ps1</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">.template</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_invoke_script</span>

    <span class="n">template_path</span> <span class="o">=</span> <span class="n">psadt_cache_dir</span> <span class="o">/</span> <span class="s2">&quot;Invoke-AppDeployToolkit.ps1&quot;</span>
    <span class="n">invoke_script</span> <span class="o">=</span> <span class="n">generate_invoke_script</span><span class="p">(</span>
        <span class="n">template_path</span><span class="p">,</span> <span class="n">config</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">psadt_version</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="n">debug</span>
    <span class="p">)</span>

    <span class="c1"># Write generated script</span>
    <span class="n">script_dest</span> <span class="o">=</span> <span class="n">build_dir</span> <span class="o">/</span> <span class="s2">&quot;Invoke-AppDeployToolkit.ps1&quot;</span>
    <span class="n">script_dest</span><span class="o">.</span><span class="n">write_text</span><span class="p">(</span><span class="n">invoke_script</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="s2">&quot;[OK] Generated Invoke-AppDeployToolkit.ps1&quot;</span><span class="p">)</span>

    <span class="c1"># Copy installer</span>
    <span class="n">_copy_installer</span><span class="p">(</span><span class="n">installer_file</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">)</span>

    <span class="c1"># Apply branding</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="s2">&quot;Applying branding...&quot;</span><span class="p">)</span>
    <span class="n">_apply_branding</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">build_dir</span><span class="p">)</span>

    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;[OK] Build complete: </span><span class="si">{</span><span class="n">build_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;app_id&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
        <span class="s2">&quot;app_name&quot;</span><span class="p">:</span> <span class="n">app_name</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
        <span class="s2">&quot;build_dir&quot;</span><span class="p">:</span> <span class="n">build_dir</span><span class="p">,</span>
        <span class="s2">&quot;psadt_version&quot;</span><span class="p">:</span> <span class="n">psadt_version</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="notapkgtool.build.template" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">notapkgtool.build.template</span>


</h2>

    <div class="doc doc-contents first">

        <p>Invoke-AppDeployToolkit.ps1 template generation for NAPT.</p>
<p>This module handles generating the Invoke-AppDeployToolkit.ps1 script by
reading PSADT's template, substituting configuration values, and inserting
recipe-specific install/uninstall code.</p>


<details class="private-helpers" open>
  <summary>Private Helpers</summary>
  <ul>
<li>_build_adtsession_vars: Build $adtSession hashtable from config</li>
<li>_replace_session_block: Replace $adtSession = @{...} in template</li>
<li>_insert_recipe_code: Insert install/uninstall code at markers</li>
<li>_format_powershell_value: Format Python values as PowerShell literals</li>
</ul>
</details>

<details class="design-principles" open>
  <summary>Design Principles</summary>
  <ul>
<li>PSADT template remains pristine in cache</li>
<li>Generate script by substitution, not modification</li>
<li>Preserve PSADT's structure and comments</li>
<li>Support dynamic values (AppScriptDate, discovered version)</li>
<li>Merge org defaults with recipe overrides</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>from pathlib import Path
from notapkgtool.build.template import generate_invoke_script</p>
<p>script = generate_invoke_script(
    template_path=Path("cache/psadt/4.1.7/Invoke-AppDeployToolkit.ps1"),
    config=recipe_config,
    version="141.0.7390.123",
    psadt_version="4.1.7"
)</p>
<p>Path("builds/app/version/Invoke-AppDeployToolkit.ps1").write_text(script)</p>
</details>









  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="notapkgtool.build.template.generate_invoke_script" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">generate_invoke_script</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">generate_invoke_script</span><span class="p">(</span><span class="n">template_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span> <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">psadt_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Generate Invoke-AppDeployToolkit.ps1 from PSADT template and config.</p>
<p>Reads the PSADT template, replaces the $adtSession hashtable with
values from the configuration, and inserts recipe-specific install/
uninstall code.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>template_path</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to PSADT's Invoke-AppDeployToolkit.ps1 template.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>config</code>
            </td>
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Merged configuration (org + vendor + recipe).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>version</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Application version (from filesystem).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>psadt_version</code>
            </td>
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PSADT version being used.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show verbose output. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>debug</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show debug output. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="str">str</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Generated PowerShell script text.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="FileNotFoundError">FileNotFoundError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If template doesn't exist.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If template parsing fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Generate deployment script from template:</p>
<pre><code>from pathlib import Path

script = generate_invoke_script(
    Path("cache/psadt/4.1.7/Invoke-AppDeployToolkit.ps1"),
    config,
    "141.0.7390.123",
    "4.1.7"
)
</code></pre>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>notapkgtool/build/template.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">generate_invoke_script</span><span class="p">(</span>
    <span class="n">template_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">],</span>
    <span class="n">version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">psadt_version</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generate Invoke-AppDeployToolkit.ps1 from PSADT template and config.</span>

<span class="sd">    Reads the PSADT template, replaces the $adtSession hashtable with</span>
<span class="sd">    values from the configuration, and inserts recipe-specific install/</span>
<span class="sd">    uninstall code.</span>

<span class="sd">    Args:</span>
<span class="sd">        template_path: Path to PSADT&#39;s Invoke-AppDeployToolkit.ps1 template.</span>
<span class="sd">        config: Merged configuration (org + vendor + recipe).</span>
<span class="sd">        version: Application version (from filesystem).</span>
<span class="sd">        psadt_version: PSADT version being used.</span>
<span class="sd">        verbose: Show verbose output. Default is False.</span>
<span class="sd">        debug: Show debug output. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Generated PowerShell script text.</span>

<span class="sd">    Raises:</span>
<span class="sd">        FileNotFoundError: If template doesn&#39;t exist.</span>
<span class="sd">        RuntimeError: If template parsing fails.</span>

<span class="sd">    Example:</span>
<span class="sd">        Generate deployment script from template:</span>

<span class="sd">            from pathlib import Path</span>

<span class="sd">            script = generate_invoke_script(</span>
<span class="sd">                Path(&quot;cache/psadt/4.1.7/Invoke-AppDeployToolkit.ps1&quot;),</span>
<span class="sd">                config,</span>
<span class="sd">                &quot;141.0.7390.123&quot;,</span>
<span class="sd">                &quot;4.1.7&quot;</span>
<span class="sd">            )</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">notapkgtool.cli</span><span class="w"> </span><span class="kn">import</span> <span class="n">print_debug</span><span class="p">,</span> <span class="n">print_verbose</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">template_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;PSADT template not found: </span><span class="si">{</span><span class="n">template_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Reading PSADT template: </span><span class="si">{</span><span class="n">template_path</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Read template</span>
    <span class="n">template</span> <span class="o">=</span> <span class="n">template_path</span><span class="o">.</span><span class="n">read_text</span><span class="p">(</span><span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>

    <span class="c1"># Build $adtSession variables</span>
    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="s2">&quot;Building $adtSession variables...&quot;</span><span class="p">)</span>
    <span class="n">session_vars</span> <span class="o">=</span> <span class="n">_build_adtsession_vars</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">version</span><span class="p">,</span> <span class="n">psadt_version</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="n">print_debug</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="s2">&quot;--- $adtSession Variables ---&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">session_vars</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">print_debug</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;  </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Replace $adtSession block</span>
    <span class="n">script</span> <span class="o">=</span> <span class="n">_replace_session_block</span><span class="p">(</span><span class="n">template</span><span class="p">,</span> <span class="n">session_vars</span><span class="p">)</span>
    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="s2">&quot;[OK] Replaced $adtSession hashtable&quot;</span><span class="p">)</span>

    <span class="c1"># Insert recipe code</span>
    <span class="n">app</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;apps&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">psadt_config</span> <span class="o">=</span> <span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;psadt&quot;</span><span class="p">,</span> <span class="p">{})</span>
    <span class="n">install_code</span> <span class="o">=</span> <span class="n">psadt_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;install&quot;</span><span class="p">)</span>
    <span class="n">uninstall_code</span> <span class="o">=</span> <span class="n">psadt_config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;uninstall&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">install_code</span><span class="p">:</span>
        <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="s2">&quot;Inserting install code from recipe&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">uninstall_code</span><span class="p">:</span>
        <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="s2">&quot;Inserting uninstall code from recipe&quot;</span><span class="p">)</span>

    <span class="n">script</span> <span class="o">=</span> <span class="n">_insert_recipe_code</span><span class="p">(</span><span class="n">script</span><span class="p">,</span> <span class="n">install_code</span><span class="p">,</span> <span class="n">uninstall_code</span><span class="p">)</span>

    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;BUILD&quot;</span><span class="p">,</span> <span class="s2">&quot;[OK] Script generation complete&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">script</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="notapkgtool.build.packager" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-module"></code>            <span class="doc doc-object-name doc-module-name">notapkgtool.build.packager</span>


</h2>

    <div class="doc doc-contents first">

        <p>.intunewin package generation for NAPT.</p>
<p>This module handles creating .intunewin packages from built PSADT directories
using Microsoft's IntuneWinAppUtil.exe tool.</p>


<details class="private-helpers" open>
  <summary>Private Helpers</summary>
  <ul>
<li>_get_intunewin_tool: Download and cache IntuneWinAppUtil.exe</li>
<li>_execute_packaging: Run IntuneWinAppUtil.exe to create .intunewin</li>
<li>_verify_build_structure: Validate PSADT build directory</li>
</ul>
</details>

<details class="design-principles" open>
  <summary>Design Principles</summary>
  <ul>
<li>IntuneWinAppUtil.exe is cached globally (not per-build)</li>
<li>Package output follows convention: {app_id}-{version}.intunewin</li>
<li>Build directory can optionally be cleaned after packaging</li>
<li>Tool is downloaded from Microsoft's official GitHub repository</li>
</ul>
</details>

<details class="example" open>
  <summary>Example</summary>
  <p>from pathlib import Path
from notapkgtool.build.packager import create_intunewin</p>
<p>result = create_intunewin(
    build_dir=Path("builds/napt-chrome/141.0.7390.123"),
    output_dir=Path("packages")
)</p>
<p>print(f"Package: {result['package_path']}")</p>
</details>









  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h3 id="notapkgtool.build.packager.create_intunewin" class="doc doc-heading">
<code class="doc-symbol doc-symbol-heading doc-symbol-function"></code>            <span class="doc doc-object-name doc-function-name">create_intunewin</span>


</h3>
<div class="doc-signature highlight"><pre><span></span><code><span class="nf">create_intunewin</span><span class="p">(</span><span class="n">build_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span> <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">clean_source</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

    <div class="doc doc-contents ">

        <p>Create a .intunewin package from a PSADT build directory.</p>
<p>Uses Microsoft's IntuneWinAppUtil.exe tool to package a PSADT build
directory into a .intunewin file suitable for Intune deployment.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>build_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Path to the built PSADT package directory.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>output_dir</code>
            </td>
            <td>
                  <code><span title="pathlib.Path">Path</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Directory for the .intunewin output.
Default: packages/{app_id}/</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>clean_source</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If True, remove the build directory
after packaging. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>verbose</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show verbose output. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>debug</code>
            </td>
            <td>
                  <code><span title="bool">bool</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Show debug output. Default is False.</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="dict">dict</span>[<span title="str">str</span>, <span title="typing.Any">Any</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dict (build_dir, package_path, app_id, version, status), where
build_dir is the Path to the build directory, package_path is
the Path to the created .intunewin file, app_id is the application
ID, version is the application version, and status is the
packaging status.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<p><span class="doc-section-title">Raises:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="ValueError">ValueError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If build directory structure is invalid.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><span title="RuntimeError">RuntimeError</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If packaging fails.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="example" open>
  <summary>Example</summary>
  <p>Basic packaging:</p>
<pre><code>result = create_intunewin(
    build_dir=Path("builds/napt-chrome/141.0.7390.123")
)
print(result['package_path'])
# packages/napt-chrome/napt-chrome-141.0.7390.123.intunewin
</code></pre>
<p>With cleanup:</p>
<pre><code>result = create_intunewin(
    build_dir=Path("builds/napt-chrome/141.0.7390.123"),
    clean_source=True
)
# Build directory is removed after packaging
</code></pre>
</details>

<details class="note" open>
  <summary>Note</summary>
  <p>Requires build directory from 'napt build' command. IntuneWinAppUtil.exe
is downloaded and cached on first use. Setup file is always
"Invoke-AppDeployToolkit.exe". Output follows convention:
packages/{app_id}/{app_id}-{version}.intunewin</p>
</details>

            <details class="mkdocstrings-source">
              <summary>Source code in <code>notapkgtool/build/packager.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_intunewin</span><span class="p">(</span>
    <span class="n">build_dir</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">clean_source</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">verbose</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">debug</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a .intunewin package from a PSADT build directory.</span>

<span class="sd">    Uses Microsoft&#39;s IntuneWinAppUtil.exe tool to package a PSADT build</span>
<span class="sd">    directory into a .intunewin file suitable for Intune deployment.</span>

<span class="sd">    Args:</span>
<span class="sd">        build_dir: Path to the built PSADT package directory.</span>
<span class="sd">        output_dir: Directory for the .intunewin output.</span>
<span class="sd">            Default: packages/{app_id}/</span>
<span class="sd">        clean_source: If True, remove the build directory</span>
<span class="sd">            after packaging. Default is False.</span>
<span class="sd">        verbose: Show verbose output. Default is False.</span>
<span class="sd">        debug: Show debug output. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A dict (build_dir, package_path, app_id, version, status), where</span>
<span class="sd">            build_dir is the Path to the build directory, package_path is</span>
<span class="sd">            the Path to the created .intunewin file, app_id is the application</span>
<span class="sd">            ID, version is the application version, and status is the</span>
<span class="sd">            packaging status.</span>

<span class="sd">    Raises:</span>
<span class="sd">        ValueError: If build directory structure is invalid.</span>
<span class="sd">        RuntimeError: If packaging fails.</span>

<span class="sd">    Example:</span>
<span class="sd">        Basic packaging:</span>

<span class="sd">            result = create_intunewin(</span>
<span class="sd">                build_dir=Path(&quot;builds/napt-chrome/141.0.7390.123&quot;)</span>
<span class="sd">            )</span>
<span class="sd">            print(result[&#39;package_path&#39;])</span>
<span class="sd">            # packages/napt-chrome/napt-chrome-141.0.7390.123.intunewin</span>

<span class="sd">        With cleanup:</span>

<span class="sd">            result = create_intunewin(</span>
<span class="sd">                build_dir=Path(&quot;builds/napt-chrome/141.0.7390.123&quot;),</span>
<span class="sd">                clean_source=True</span>
<span class="sd">            )</span>
<span class="sd">            # Build directory is removed after packaging</span>

<span class="sd">    Note:</span>
<span class="sd">        Requires build directory from &#39;napt build&#39; command. IntuneWinAppUtil.exe</span>
<span class="sd">        is downloaded and cached on first use. Setup file is always</span>
<span class="sd">        &quot;Invoke-AppDeployToolkit.exe&quot;. Output follows convention:</span>
<span class="sd">        packages/{app_id}/{app_id}-{version}.intunewin</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">notapkgtool.cli</span><span class="w"> </span><span class="kn">import</span> <span class="n">print_step</span><span class="p">,</span> <span class="n">print_verbose</span>

    <span class="n">build_dir</span> <span class="o">=</span> <span class="n">build_dir</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">build_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Build directory not found: </span><span class="si">{</span><span class="n">build_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Extract app_id and version from directory structure (app_id/version/)</span>
    <span class="n">version</span> <span class="o">=</span> <span class="n">build_dir</span><span class="o">.</span><span class="n">name</span>
    <span class="n">app_id</span> <span class="o">=</span> <span class="n">build_dir</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">name</span>

    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;PACKAGE&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Packaging </span><span class="si">{</span><span class="n">app_id</span><span class="si">}</span><span class="s2"> v</span><span class="si">{</span><span class="n">version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Verify build structure</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Verifying build structure...&quot;</span><span class="p">)</span>
    <span class="n">_verify_build_structure</span><span class="p">(</span><span class="n">build_dir</span><span class="p">)</span>

    <span class="c1"># Determine output directory</span>
    <span class="k">if</span> <span class="n">output_dir</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;packages&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="n">app_id</span>

    <span class="n">output_dir</span> <span class="o">=</span> <span class="n">output_dir</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>

    <span class="c1"># Get IntuneWinAppUtil tool</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Getting IntuneWinAppUtil tool...&quot;</span><span class="p">)</span>
    <span class="n">tool_cache</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;cache/tools&quot;</span><span class="p">)</span>
    <span class="n">tool_path</span> <span class="o">=</span> <span class="n">_get_intunewin_tool</span><span class="p">(</span><span class="n">tool_cache</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

    <span class="c1"># Create .intunewin package</span>
    <span class="n">print_step</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Creating .intunewin package...&quot;</span><span class="p">)</span>
    <span class="n">package_path</span> <span class="o">=</span> <span class="n">_execute_packaging</span><span class="p">(</span>
        <span class="n">tool_path</span><span class="p">,</span>
        <span class="n">build_dir</span><span class="p">,</span>
        <span class="s2">&quot;Invoke-AppDeployToolkit.exe&quot;</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="p">,</span>
        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Optionally clean source</span>
    <span class="k">if</span> <span class="n">clean_source</span><span class="p">:</span>
        <span class="n">print_step</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Cleaning source build directory...&quot;</span><span class="p">)</span>
        <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">build_dir</span><span class="p">)</span>
        <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;PACKAGE&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;[OK] Removed build directory: </span><span class="si">{</span><span class="n">build_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">print_step</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Package complete&quot;</span><span class="p">)</span>

    <span class="n">print_verbose</span><span class="p">(</span><span class="s2">&quot;PACKAGE&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;[OK] Package created: </span><span class="si">{</span><span class="n">package_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;build_dir&quot;</span><span class="p">:</span> <span class="n">build_dir</span><span class="p">,</span>
        <span class="s2">&quot;package_path&quot;</span><span class="p">:</span> <span class="n">package_path</span><span class="p">,</span>
        <span class="s2">&quot;app_id&quot;</span><span class="p">:</span> <span class="n">app_id</span><span class="p">,</span>
        <span class="s2">&quot;version&quot;</span><span class="p">:</span> <span class="n">version</span><span class="p">,</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>