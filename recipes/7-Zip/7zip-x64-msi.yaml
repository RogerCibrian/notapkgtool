apiVersion: napt/v1
project: "napt - Windows Apps"

app:
  name: "7-Zip"
  id: "napt-7zip"

  source:
      strategy: web_scrape
      page_url: "https://www.7-zip.org/download.html"
      link_selector: 'a[href$="-x64.msi"]'
      version_pattern: "7z(\\d{2})(\\d{2})-x64"
      version_format: "{0}.{1}"

  psadt:
      app_vars:
        AppName: "7-Zip"
        AppVersion: "${discovered_version}"
        AppArch: "x64"
        AppVendor: "Igor Pavlov"
      install: |
        # Install 7-Zip MSI with system-wide deployment
        # Note: Filename uses compact version (e.g., 7z2501-x64.msi for v25.01)
        Start-ADTMsiProcess -Action Install -Path "$dirFiles\7z*-x64.msi" -Parameters "ALLUSERS=1"
      uninstall: |
        # Uninstall 7-Zip automatically (handles MSI ProductCode lookup)
        Uninstall-ADTApplication -Name "7-Zip"

